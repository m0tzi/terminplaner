<!DOCTYPE html>
<html lang="de">

<head>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="CSS/Test.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http - equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script>
        var Token;
        var Endpoint = "http://localhost/cgi-bin/Test.exe";

        function CallServer(parameter) {
            var Prom = jQuery.Deferred();
            $.ajax({
                url: Endpoint,
                method: "Post",
                data: parameter
            }).done(function(data) {
                console.log("ERFOLG");
                console.log(data);
                Prom.resolve(data);
            }).fail(function(data) {
                console.log("Misserfolg");
                console.log(data);
                Prom.reject();
            });
            return Prom.promise();
        }

        function CreateDate() {
            var parameter = {
                "Token": Token,
                "Desc": $("#Desc").val(),
                "Time": $("#Time").val(),
                "DateName": $("#DateName").val(),
                "Befehl": "CreateDate"
            }
            CallServer(parameter);
        }

        function GetDates() {
            console.log(Token);
            var parameter = {
                "Token": Token,
                "Befehl": "GetDates"
            }
            CallServer(parameter);
        }

        function CreateUser() {
            var parameter = {
                "Username": $("#UsernameEnter").val(),
                "Password": $("#PasswordEnter").val(),
                "Befehl": "CreateUser"
            }
            $.when(CallServer(parameter)).done(function(data) {
                Token = data.Server;
                createDashboard();
            });
        }

        function GetToken() {
            var parameter = {
                "Username": $("#UsernameEnter").val(),
                "Password": $("#PasswordEnter").val(),
                "Befehl": "GetToken"
            }
            $.when(CallServer(parameter)).done(function(data) {
                Token = data.Server;
                createDashboard();
            });
        }

        async function createDashboard() {
            $.when(GetDates()).done(function() {

            });
            $(".CenterMe").addClass("hide");
            $(".Dashboard").removeClass("hide");
        }
        $(document).ready(function() {
            //WIP
        })
    </script>
</head>

<body>
    <div class="wrap-all">
    <div class="CenterMe">
        <div class="Startpage">
            <div class="inputs">
                <input type="text" placeholder="Username" id="UsernameEnter" />
                <input type="password" placeholder="Password" id="PasswordEnter" />
            </div>
            <div class="inputs-btn">
                <button class="btn-login" onclick="GetToken()">
                    Login
                </button>
                <button class="btn-login" onclick="CreateUser()">
                    Register
                </button>
            </div>
        </div>
    </div>

    <div class="Dashboard hide">
        <div class="Userdata">

        </div>
        <div class="Logout">
            
        </div>
        <div class="Main">
            <div class="Befehle">
                <div class="content">WIP<br>Add Date</div>
            </div>
            <div class="displayDates">
                <div class="content">
                    <p class="title">
                        Ãœberschrift
                    </p>
                    <p class="desc">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quos nesciunt doloremque consectetur debitis quam dignissimos cupiditate quidem aliquid alias! Id culpa animi aliquid! Optio soluta nesciunt consectetur aliquam dolor provident?
                    </p>
                    <p class="Datum">11.1.2019</p>

                </div>
                <div class="content"></div>
                <div class="content"></div>
                <div class="content"></div>
                <div class="content"></div>
                <div class="content"></div>
                <div class="content"></div>
                <div class="content"></div>

            </div>
        </div>
    </div>
</div>
</body>

</html>